<!DOCTYPE html>
<!-- saved from url=(0038)http://getbootstrap.com/examples/grid/ -->
<html lang="en">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="http://getbootstrap.com/favicon.ico">

    <title>Data</title>

    <link href="bootstrap.min.css" rel="stylesheet">
    <link href="grid.css" rel="stylesheet">
    <style type="text/css">
        .center {
            margin: auto;
        }
    </style>
</head>

<body style="padding-top: 70px;">

<nav class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">
        <ul class="nav navbar-nav">
            <li><a href="index.html">Home</a>
            </li>
            <li><a href="team.html">Team and Roles</a>
            </li>
            <li><a href="progress.html">Progress</a>
            </li>
            <li><a href="user_manual.html">User Manual</a>
            </li>
            <li class="active"><a href="data.html">Data</a>
            </li>
            <li><a href="source_code.html">Source Code</a>
            </li>
            <li><a href="findings.html">Findings</a>
            </li>
        </ul>
    </div>
</nav>

<div class="container">
    <div class="page-header">
        <h1>Data</h1>
        <p class="lead">The real-time heart of the application</p>
    </div>

    <h3>311 Datasets</h3>
    <p>
        311 service is generally implemented at the local level, and in some cities, it is also used for various municipal calls.
        The service in chicago uses to collect a bunch of data and release them live to the web for free. Live means that the dataset is updated with a certain frequency
        that goes from minutes two variuos days, and they can be easily accessed and queried real time with the API that they provide. The main page where to find data can
        be found starting from <a href="https://data.cityofchicago.org/browse?limitTo=datasets">here</a> and the SODA2 API webpage used to query the datasets is available
        <a href="http://dev.socrata.com/docs/queries.html">here</a>.

    <h4>Potholes Data</h4>
    <p>
        The 311 service keeps a dataset of potholes in Chicago at <a href="https://data.cityofchicago.org/Service-Requests/311-Service-Requests-Pot-Holes-Reported/7as2-ds3y">this page</a>,
        that can be easily queried by downloading the linked <a href="http://data.cityofchicago.org/resource/7as2-ds3y.json">JSON file</a> and appending the parameters in the URL.
        The parameters we specified have been chosen as explained below:
    <ul>
        <li>$select = only the fields we needed to display</li>
        <li>$where = latitude and longitude are not NULL (to display the pothole), the pothole hasn't been fixed yet, and it has been pointed out in the last month</li>
        <li>$order = order by date to have sorted set to manipulate</li>
    </ul>
    The data is retrieved when the user activates the layer and is asynchronously downloaded, parsed and displayed. The frequency of updates is 1 minute, so that the user
    can possibly see live updates if new data is available.
    </p>

    <h4>Street Lights Out Data</h4>
    <p>
        The 311 service keeps a dataset of broken street lights in Chicago at <a href="https://data.cityofchicago.org/Service-Requests/311-Service-Requests-Street-Lights-All-Out/zuxi-7xem">this page</a>,
        where are listed all the poles with 3 or more lights out, and <a href="https://data.cityofchicago.org/Service-Requests/311-Service-Requests-Street-Lights-One-Out/3aav-uy2v">this page</a> where
        are listed the poles with 1 or 2 lights out. Data can be easily queried by downloading the linked JSON files and appending the parameters in the URL.
        The parameters we specified have been chosen as explained below:
    <ul>
        <li>$select = only the fields we needed to display</li>
        <li>$where = latitude and longitude are not NULL (to display the lights on the map) and the broken lights has been pointed out in the last month but still hasn't been given back</li>
        <li>$order = order by date to have sorted set to manipulate</li>
    </ul>
    The data is retrieved when the user activates the layer and is asynchronously downloaded, parsed and displayed. The frequency of updates is 1 minute, so that the user
    can possibly see live updates if new data is available.
    </p>

    <h4>Abandoned Vehicles Data</h4>
    <p>
        The 311 service keeps a dataset of abandoned vehicles in Chicago at <a href="https://data.cityofchicago.org/Service-Requests/311-Service-Requests-Abandoned-Vehicles/3c9v-pnva">this page</a>,
        that can be easily queried by downloading the linked <a href="http://data.cityofchicago.org/resource/3c9v-pnva.json">JSON file</a> and appending the parameters in the URL.
        The parameters we specified have been chosen as explained below:
    <ul>
        <li>$select = only the fields we needed to display</li>
        <li>$where = latitude and longitude are not NULL (to display the vehicle on the map) and the vehicle has been pointed out in the last month but still hasn't been given back</li>
        <li>$order = order by date to have sorted set to manipulate</li>
    </ul>
    The data is retrieved when the user activates the layer and is asynchronously downloaded, parsed and displayed. The frequency of updates is 1 minute, so that the user
    can possibly see live updates if new data is available.
    </p>

    <h4>Crimes Data</h4>
    <p>
        The 311 service keeps a dataset of crimes in Chicago at <a href="https://data.cityofchicago.org/Public-Safety/Crimes-2001-to-present/ijzp-q8t2">this page</a>,
        that can be easily queried by downloading the linked <a href="http://data.cityofchicago.org/resource/ijzp-q8t2.json">JSON file</a> and appending the parameters in the URL.
        The parameters we specified have been chosen as explained below:
    <ul>
        <li>$select = only the fields we needed to display</li>
        <li>$where = latitude and longitude are not NULL (to display the vehicle on the map) and the crime has been pointed out in the last month</li>
        <li>$order = order by date to have sorted set to manipulate</li>
    </ul>
    The data is retrieved when the user activates the layer and is asynchronously downloaded, parsed and displayed. With this particular dataset, the handling of the results is
    more tricky since the data retrieved is significantly bigger (10 times bigger than the data described above), so the asynchronous download and the cache of the data has been
    fundamental to avoid the application freeze and increase the usability. Also, we decided to classify the crimes into 3 distinct categories that have been assigned to each single
    crime starting from it's type. For example:
    <ul>
        <li>Type = Theft -> Category = Property Crime</li>
        <li>Type = Burglar -> Category = Property Crime</li>
        <li>Type = Homicide -> Category = Violent Crime</li>
        <li>Type = Battery -> Category = Violent Crime</li>
        <li>Type = Prostitution -> Category =  Quality of Life Crime</li>
        <li>Type = Gambling -> Category =  Quality of Life Crime</li>
    </ul>
    and so on ... In this way turns really meaningful make comparison and statistics on the different kind of crimes.
    </p>

    <h3>Divvy Bikes Data</h3>
    Divvy is a bicycle sharing system that launched in Chicago on June 28, 2013 initially with 750 bikes at 75 stations spanning from the Loop north to Berwyn Ave, west to Kedzie Ave, and south to 59th St.
    The system was planned to grow to 4,000 bicycles at 400 stations by Spring 2014, however supply shortages have delayed expansion to 2015.

    <h4>Bikes Data</h4>
    <p>
        The company released a bunch of historical data on their launch, and now keeps updating <a href="http://www.divvybikes.com/stations/json/">this JSON file</a>
        every minute with the information of all the divvy bikes stations in Chicago. The application checks if new data is available every 10 seconds, so that the user
        is actually aware of the stations status in real time.
        The only issue that we encountered with the download of this file was how bypass of the Cross Site Domain error that was given from our server, and we managed it using
        <a href="https://script.google.com/a/macros/mcpher.com/s/AKfycbzGgpLEWS0rKSBqXG5PcvJ7Fpe02fvGqiCqq54SVQmBJSpy_6s/exec?url=http://www.divvybikes.com/stations/json/">this proxy server</a> owned by Google.
    </p>

    <h3>Other Resources</h3>
    We felt like the application could show much more than that, and we decided to extend it by getting other data from external resources to give more useful real time
    information. In general to get this data we decided to use a php script to authenticate i a easier way with the server, and pass trough the Google proxy mentioned
    before.

    <h4>Yelp Data</h4>
    <p>
        Yelp is a multinational corporation headquartered in San Francisco, California and provides basic data about businesses such as hours of operation. We have used
        <a href="http://www.yelp.com/developers/documentation">their APIs</a> to retrieve data about the best classified restaurants in Chicago. Unfortunately the sorting by rate
        only allows to retrieve 40 results, which were not enough for what we wanted to visualize. So we have decided to retrieve them with the 'best match' criteria, which
        gives back up to 1000 preferred restaurants sorted with a complex algorithm that takes into account many more factors than just rating.
        This results have been combined with the data that can found <a href="https://data.cityofchicago.org/Health-Human-Services/Food-Inspections/4ijn-s7e5">here</a> to highlight
        the preferred restaurant that have failed a food inspection in the last few months.
    </p>

    <h4>Twitter Data</h4>
    <p>
        Twitter is a really powerful instrument nowadays, that can give tons of useful information if they area well filtered. The <a href="https://dev.twitter.com/overview/documentation">Twitter APIs</a>
        are really straightforward and easy to use; the biggest challenge has been to find some interesting tweets regarding the purpose of the application: security on the street.
        We noticed that important tweets regarding crimes and inconviniences come from settle down companies like #BreakingNews that usually don't share their location, while everyday users that
        are geolocalized cannot be trusted apriori regarding this kind of alerts. Eventually we decided not to the meaningless geotagged tweets on the map, but rather
        untagged meaningful tweets as simple notifications.
    </p>

    <h4>Wikipedia Data</h4>
    <p>
        We used wikipedia just as external resource to retrive information about tourist attractions and important places. No API has been used, the information have been
        taken directly from the Wikipedia web pages.
    </p>

    <h3>CTA APIs</h3>
    Data about bus and trains are retrieved taking advantage of the CTA APIs.
    <br>
    CTA provide two handy manuals for its APIs:
    <ul>
        <li>
            <a href="http://www.transitchicago.com/developers/bustracker.aspx">BUS Tracker API</a>
        </li>
        <li>
            <a href="http://www.transitchicago.com/developers/traintracker.aspx">Train Tracker API</a>
        </li>
    </ul>

    <h4>Bus</h4>
    <p>
        For Buses the “Bus Tracker API documentation” has been used. Since it provided not so user-friendly “calls” for
        the purposes of this application, a good design about queries and their optimization has been needed.
    </p>

    <h5>Query Hierarchy</h5>
    <p>
        The main API calls are:
    <ul>
        <li><b>getroutes</b>
            <p style="margin:0px 15px">which returns the list of all the cta routes</p>
        </li>
        <li><b>getroutedirections?Rt=XXX</b>
            <p style="margin:0px 15px">which returns all the directions given a route</p>
        </li>
        <li><b>getstops?rt=XXX&dir=YYY</b>
            <p style="margin:0px 15px">which returns all the stops given a route and a direction</p>
        </li>
        <li><b>getvehicles?Rt=XXX</b>
            <p style="margin:0px 15px">which returns all the vehicles given a route</p>
        </li>
        <li><b>getpatterns?rt=XXX</b>
            <p style="margin:0px 15px">which returns a list of the geographic points that compose the route</p>
        </li>
        <li><b>getpredictions?stpid=XXX</b>
            <p style="margin:0px 15px">which returns a list of time predictions for a given stop</p>
        </li>
    </ul>
    </p>

    <p>
        As it is possible to notice, having a list of vehicles or stops for a particular area is not straightforward.
        Retrieving the whole list of stops would be a process which involves too many calls. For this reason,
        it has been decided to save a local copy of the bus stops which is updated everyday.
        This list of stops is retrieved according to the following scheme:
    </p>

    <ol>
        <li><b>getroutes</b></li>
        <li>for all routes -> <b>getroutedirections</b></li>
        <li>for all routes and directions -> <b>getstops</b></li>
    </ol>
    <p>
        To this list of stops, the geographic selection filter is applied in order to reduce the size of it.<br>
    </p>
    <p>
        Once obtained a filtered list, it is scanned to find all the routes of the selected area by simply checking the route of each stop.<br>
        With the list of all the active routes of an area it is now possible to call the <b>getvehicles</b> API to retrieve a list of vehicles.
        This list too is filtered to have just the vehicles currently inside the selected area.<br>
        The list of the active routes is also used to call the <b>getpatterns</b> api, which returns all the paths of those routes.<br>
    </p>
    <p>
        After a click on the popup of a station a <b>getprediction</b> call is made with the id of the selected station.
    </p>

    <h5>Bus Animation</h5>
    <p>
        Data about vehicles is updated on the CTA servers just once every minute. This is such a long time for information like
        position of buses and it is difficult to provide the user useful information. With this kind of update rate it is
        even difficult to understand which direction they are moving to.<br>
        For these reasons it has been decided to simulate the positions of buses in between two consecutive updates.
        This is pursued through some steps.
    </p>
    <h6>Mobile mean adjusted speed</h6>
    <p>
        Once an update arrives, data about the previous data is stored in order to compute the speed of the last "step".
        The speed of the bus is set as a mean between an empirical value (that has been found analyzing the buses) and
        the mobile mean of the latest 5 speed values of the bus.
    </p>
    <h6>Route Repositioning</h6>
    <p>
        Position data of the buses is not so accurate and in some particular conditions like, for instance, when the bus is
        downtown among the skyscrapers, the signal is very noisy. For this reason each bus is repositioned on his track.<br>
        Since every bus "is aware" of the route it is traveling on, it is possible to set the position of the bus on the route
        in a precise way. This task is accomplished by computing the distance between the bus position and each segment
        which the route path is composed of. The segment with the smaller distance is chosen and the bus is positioned in between it
        by simply following a perpendicular line toward it.
    </p>
    <h6>Animation</h6>
    <h6>New data update</h6>


    <p></p>



    <hr>

</div> <!-- /container -->
</body>
</html>